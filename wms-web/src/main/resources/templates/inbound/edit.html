<!DOCTYPE html>
<html>
<head>
    <title wms:text="${wms.inbound.title}">入库单</title>
    <head th:replace="common/head" />
    <script th:replace="common/js" />
    <script type="text/javascript" th:src="@{/js/codelkupList?listName=INBOUNDTYPE,INBOUNDSTATUS,LOCATIONTYPE,UOM}"></script>
	<script type="text/javascript" th:src="@{/static/ui/plugins/datagrid-filter.js}"></script>
    <style>
    	td{
	    	border:0px;
	    	padding: 0px;
	    	margin: 0px;
    	}
    	table {
		    border-spacing: 0;
		}
    </style>
</head>
<body class="easyui-layout" style="opacity: 1;">
	<div class="icon-loading" style="position: absolute; z-index: 999999;width: 100%; height: 100%;opacity: 1;background-color: white;" >&nbsp;</div>
	<div data-options="region:'north',collapsible:false" style="height:35px;">
		<div class="tableToolbar">
			<a href="#" class="easyui-linkbutton inbound-save" data-form="#inboundHeaderForm" >
				<span wms:text="${web.label.save}">Save</span>
			</a>
		</div>
	</div>
	<div class="easyui-layout" data-options="region:'center',collapsible:false">
		<div data-options="region:'north',collapsible:false,split:true" wms:title="${web.label.inbound.heander}" style="height: 300px;">
			<div th:replace="inbound/header" />
		</div>
		<div data-options="region:'center',border:false" >
			<div th:replace="inbound/detail" />
		</div>
	</div>
</body>
<script type="text/javascript" th:inline="text">
	lazyLoadView('#headerTab1');
	loadDetailListToolbarView();
	loadDetailListView();
	$(function(){
		$('.inbound-save').click(function(){
			var from = $(this).attr('data-form');
			var url = $(from).attr('data-url');
			var valid = $(from).form('validate');
			if (!valid) {
				return;
			}
			var detailData = getInboundDetailChangeData(); // import function
			var headerData = getInboundHeaderData(); // import function
			headerData['detail'] = detailData;
			var data = getBaseData(headerData);
			loading();
			$.post({
				url: url,
				data:data,
				success: function(data){
					data = returnData(data);
					closeLoading();
					if (data.code == '0') {
						showError(data.msg);
						return;
					}
					refreshInboundDetail(data.data);
					$(panel).dialog('close');
				}
			});
		});
		setTimeout(function(){
			lazyLoadView('#addDetailDiv');
			lazyLoadView('#inboundHeaderForm');
		}, 1);
	});
	
</script>
</html>
